<ml-nav-menu name="settings"></ml-nav-menu>
<ml-calendars-list ng-controller="MlCalendarsList">
  <ml-message-bar ></ml-message-bar>

  <div class="calendars-list-container">
    <div>
      <div class="kuiViewContent kuiViewContent--constrainedWidth">
        <div class="kuiViewContentItem kuiControlledTable kuiVerticalRhythm">
          <div class="kuiToolBar">
            <div class="kuiToolBarSearch">
              <tool-bar-search-box
                ng-disabled="true"
                filter="query"
                on-filter="onQueryChange">
              </tool-bar-search-box>
            </div>

            <div class="kuiToolBarSection">
              <div
                ng-class="buttonChecks.newButtonWrapperClass()"
                ng-attr-tooltip="{{buttonChecks.newButtonWrapperTooltip()}}"
              >
                <button class="kuiButton kuiButton--primary"
                  ng-click="newCalendarClick()"
                  aria-label="{{ ::'xpack.ml.settings.calendarsList.createCalendarAriaLabel' | i18n: {defaultMessage: 'Create new calendar'} }}"
                  tooltip="Create new calendar"
                  ng-disabled='buttonChecks.newButtonDisabled()'
                  tooltip-append-to-body="true">
                  <span aria-hidden="true" class="kuiButton__icon kuiIcon fa-plus"></span>
                  <span
                    i18n-id="xpack.ml.settings.calendarsList.createCalendarButtonLabel"
                    i18n-default-message="New calendar"
                  ></span>
                </button>
              </div>
            </div>

            <div class="kuiToolBarSection">
              <tool-bar-pager-text
                start-item="pager.startItem"
                end-item="pager.endItem"
                total-items="pager.totalItems">
              </tool-bar-pager-text>
              <tool-bar-pager-buttons
                has-previous-page="pager.hasPreviousPage"
                has-next-page="pager.hasNextPage"
                on-page-next="onPageNext"
                on-page-previous="onPagePrevious">
              </tool-bar-pager-buttons>
            </div>
          </div>

          <table class="kuiTable">
            <thead>
              <tr>
                <th scope="col" class="kuiTableHeaderCell">
                  <sortable-column field="{{SORT_FIELD_LABELS.CALENDAR_ID}}" on-sort-change="onSortChange" sort-field="sortField" sort-reverse="sortReverse">
                    <span
                      i18n-id="xpack.ml.settings.calendarsList.idColumnName"
                      i18n-default-message="ID"
                    ></span>
                  </sortable-column>
                </th>
                <th scope="col" class="kuiTableHeaderCell">
                  <sortable-column field="{{SORT_FIELD_LABELS.JOB_IDS}}" on-sort-change="onSortChange" sort-field="sortField" sort-reverse="sortReverse">
                    <span
                      i18n-id="xpack.ml.settings.calendarsList.jobsColumnName"
                      i18n-default-message="Jobs"
                    ></span>
                  </sortable-column>
                </th>
                <th scope="col" class="kuiTableHeaderCell">
                  <sortable-column field="{{SORT_FIELD_LABELS.EVENT_COUNT}}" on-sort-change="onSortChange" sort-field="sortField" sort-reverse="sortReverse">
                    <span
                      i18n-id="xpack.ml.settings.calendarsList.eventsColumnName"
                      i18n-default-message="Events"
                    ></span>
                  </sortable-column>
                </th>
                <th scope="col" class="kuiTableHeaderCell actions-col"></th>
              </tr>
            </thead>

            <tbody>
              <tr ng-repeat="calendar in displayCalendars" class="kuiTableRow" ng-class="{ 'kuiTableRow-isBeingDeleted': calendar.isBeingDeleted }">

                <td class="kuiTableRowCell">
                  <div class="kuiTableRowCell__liner">
                    <span title="{{calendar.calendar_id}}">
                      {{calendar.calendar_id}}
                    </span>
                  </div>
                </td>

                <td class="kuiTableRowCell">
                  <div class="kuiTableRowCell__liner">
                    <span title="{{calendar.job_ids.join(', ')}}">
                      {{calendar.job_ids.join(', ')}}
                    </span>
                  </div>
                </td>
                <td class="kuiTableRowCell">
                  <div class="kuiTableRowCell__liner">
                    <span
                      i18n-id="xpack.ml.settings.calendarsList.calendarEventsText"
                      i18n-default-message="{calendarEventsLength, plural, one {# event} other {# events}}"
                      i18n-values="{ calendarEventsLength: calendar.events.length }"
                    ></span>
                  </div>
                </td>
                <td class="kuiTableRowCell">
                  <div class="kuiTableRowCell__liner">
                    <div class="kuiMenuButtonGroup kuiMenuButtonGroup--alignRight">
                      <div
                        ng-class="buttonChecks.newButtonWrapperClass()"
                        ng-attr-tooltip="{{buttonChecks.newButtonWrapperTooltip()}}">
                        <button
                          class="kuiMenuButton kuiMenuButton--basic kuiMenuButton--iconText"
                          aria-label="{{ ::'xpack.ml.settings.calendarsList.editCalendarAriaLabel' | i18n: {
                            defaultMessage: 'Edit {calendarId}',
                            values: {
                              calendarId: calendar.calendar_id,
                            }
                          } }}"
                          ng-disabled='buttonChecks.newButtonDisabled()'
                          ng-click="editCalendarClick(calendar.calendar_id)">
                          <span class="kuiMenuButton__icon kuiIcon fa-pencil"></span>
                          <span
                            i18n-id="xpack.ml.settings.calendarsList.editCalendarButtonLabel"
                            i18n-default-message="Edit"
                          ></span>
                        </button>
                      </div>
                      <div
                        ng-class="buttonChecks.deleteButtonWrapperClass()"
                        ng-attr-tooltip="{{buttonChecks.deleteButtonWrapperTooltip()}}">
                        <button
                          class="kuiMenuButton kuiMenuButton--danger kuiMenuButton--iconText"
                          aria-label="{{ ::'xpack.ml.settings.calendarsList.deleteCalendarAriaLabel' | i18n: {
                            defaultMessage: 'Delete {calendarId}',
                            values: {
                              calendarId: calendar.calendar_id,
                            }
                          } }}"
                          ng-disabled='buttonChecks.deleteButtonDisabled()'
                          ng-click="deleteCalendarClick(calendar.calendar_id)"
                          href="" >
                          <span class="kuiMenuButton__icon kuiIcon fa-trash"></span>
                          <span
                            i18n-id="xpack.ml.settings.calendarsList.deleteCalendarButtonLabel"
                            i18n-default-message="Delete"
                          ></span>
                        </button>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div>
</ml-calendars-list>
